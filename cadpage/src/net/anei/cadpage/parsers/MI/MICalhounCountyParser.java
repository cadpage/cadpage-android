package net.anei.cadpage.parsers.MI;

import java.util.Properties;
import java.util.regex.Pattern;

import net.anei.cadpage.parsers.MsgInfo.Data;
import net.anei.cadpage.parsers.dispatch.DispatchPrintrakParser;

/*
Calhoun County, MI
Contact: Tim Smith <timsmith1923@gmail.com>
Sender: postmaster@calhouncountymi.gov
System PrinTrak

PRI: 0 INC: F15111123000853 TYP: UNKN ROLLOVER ACC AD: 10921 BELLEVUE RD CTY: PT CN: GAW, LEWIS TIME: 07:30 151531 XST: 20199 11
PRI: 2 INC: F15111123000852 TYP: TREE/LIMB DOWN AD: CLEAR LAKE RD&WALKINSHAW RD CTY: PT CN: BILL BAMMER CMT1: TREE DOWN BLOCKING
PRI: 1 INC: F15111122000851 TYP: P1 MEDICAL APT: 19 AD: 1419 NE CAPITAL AVE CTY: PT LOC: PINES AT PENNFIELD CN: FEMALE CMT1: PIN
PRI: 2 INC: F15111121000849 TYP: CITIZEN ASSIST AD: 1427 NE CAPITAL AVE CTY: PT LOC: PINES AT PENNFIELD CN: TAKESH WORTHEM CMT1:
PRI: 1 INC: F15111121000850 TYP: P1 MEDICAL AD: 23650 M78 CTY: PT LOC: MELVIN WHITING RESD CN: LIFEALERT CMT1: --89YOM--HEART BE
PRI: 2 INC: F15111121000849 TYP: CITIZEN ASSIST AD: 1427 NE CAPITAL AVE CTY: PT LOC: PINES AT PENNFIELD CN: TAKESH WORTHEM CMT1:

Contact: Rick Bonney <bonneyrick@gmail.com>
Sender: vtext.com@gmail.com
marshalltwpfire+caf_=2692824689=vtext.com@gmail.com PRI: 1 INC: F13120110000005 TYP: NO TYPE DESCRP AVAIL APT: 61 AD: 201 WEST DR N CTY: MT LOC: ASHGROVE APARTMENTS CN: BRIAN DARGI
marshalltwpfire+caf_=2692824689=vtext.com@gmail.com PRI: 0 INC: F13120111000007 TYP: UNKNOWN ACCIDENT AD: MICHIGAN AVE&I69 SB CTY: MT CN: DENISE MATHERS CMT1: CALLER HEARD WHAT SOU

Contact: Active911
[] PRI: 1 INC: F07120614000534 TYP: BRUSH/GRASS FIRE AD: 321 SAWYER ST CTY: ET LOC: CALLBK=(517)962-1010 CN: DUSTIN NELSON CMT1: 10X10 FOOT BRUSH FIRE MOVING TWD THE WOODS, NOT THREAT TO STRUCTURES CMT2: Original Location : CALLBK=(517)962-101\n
[] PRI: 1 INC: F07120614000534 TYP: BRUSH/GRASS FIRE AD: 321 SAWYER ST CTY: ET LOC: CALLBK=(517)962-1010 CN: DUSTIN NELSON CMT1: 10X10 FOOT BRUSH FIRE MOVING TWD THE WOODS, NOT THREAT TO STRUCTURES CMT2: Original Location : CALLBK=(517)962-101\n
[] PRI: 1 INC: F07120615000535 TYP: P1 MEDICAL AD: 1275 E MICHIGAN AVE CTY: ET CN: AMBLER,LORI CMT1: CE: 87 YEAR OLD FEMALE CONSCIOUS BREATHING BREATHING PROBLEMS CALLER CMT2: STATEMENT: RESIDENT TRBL BREATHING TIME: 09:27 0707PAGE1 0707ONDTY \n
[] PRI: 1 INC: F07120615000536 TYP: P1 MEDICAL AD: 11177 MICHIGAN AVE CTY: ET LOC: FIREKEEPERS CASINO CN: FIREKEEPERS DEVELOPM CMT1: RESTROOM-USE BUS ENTR CMT2: CE: 25 YEAR OLD MALE UNCONSCIOUS BREATHING STATUS UNKNOWN CARDIAC OR TIME: 10:44 0\n
[] PRI: 1 INC: F07120615000537 TYP: P1 MEDICAL AD: 11177 MICHIGAN AVE CTY: ET LOC: FIREKEEPERS CASINO CN: FIREKEEPERS DEVELOPM CMT1: REQUESTING MEDICAL P1. CMT2: SiblingInc LET120615003613 UPDATE PriUnt to ET/761 TIME: 13:46 0707PAGE1 070752 0\n
[] PRI: 1 INC: F07120615000538 TYP: P1 MEDICAL AD: 142 JERICHO RD CTY: ET CN: AUTUMN HAWKINS CMT1: DAUGHTER IS NOT RESPONDING WELL CMT2: CE: 2 YEAR OLD FEMALE UNCONSCIOUS BREATHING UNCONSCIOUS / FAINTING (N TIME: 20:33 0707PAGE1 0707ONDTY 07EF\n
[] PRI: 2 INC: F07120616000539 TYP: ODOR INSIDE APT: 1/2 AD: 560 WESTBROOK AVE CTY: ET CN: CHAD JUAREZ CMT1: VERY STRONG ODOR OF NATURAL GAS-CALLER DID HAVE A HEADACHE BUT AFTER OPEI CMT2: NG A COUPLE WINDOWS, HE AND HIS WIFE GOT OUT. HE WOULD\n


*/

public class MICalhounCountyParser extends DispatchPrintrakParser {
  
  private static final Pattern M_ROUTE_PTN = Pattern.compile("\\bM *(\\d+)\\b"); 
  
  public MICalhounCountyParser() {
    super(CITY_TABLE, "CALHOUN COUNTY", "MI");
  }
  
  @Override
  public String getFilter() {
    return "postmaster@calhouncountymi.gov";
  }
  
  
  @Override
  protected boolean parseMsg(String body, Data data) {
    if (!super.parseMsg(body, data)) return false;
    
    // Correct Mnn to MI nn
    data.strAddress = M_ROUTE_PTN.matcher(data.strAddress).replaceAll("MI $1");
    return true;
  }


  private static final Properties CITY_TABLE = buildCodeTable(new String[]{
      "AL", "ALBION",
      "AS", "ATHENS TWP",
      "AT", "ALBION TWP",
      "BC", "BATTLE CREEK",
      "BE", "BEDFORD TWP",
      "BT", "BURLINGTON TWP",
      "BU", "BURLINGTON",
      "CL", "CLARENCE TWP",
      "CT", "CLARENDON TWP",
      "CO", "CONVIS TWP",
      "EC", "ECKFORD TWP",
      "ET", "EMMETT TWP",
      "FT", "FREDONIA TWP",
      "HO", "HOMER VILLIAGE",
      "HP", "HOMER TWP",
      "LE", "LEE TWP",
      "LT", "LEROY TWP",
      "MA", "MARSHALL",
      "MO", "MARENGO TWP",
      "MT", "MARSHALL TWP",
      "NT", "NEWTON TWP",
      "PT", "PENNFIELD TWP",
      "SF", "SPRINGFIELD",
      "ST", "SHERIDAN TWP",
      "TK", "TEKONSHA",
      "TT", "TEKONSHA TWP",
      "VA", "ATHENS"
  });
}
