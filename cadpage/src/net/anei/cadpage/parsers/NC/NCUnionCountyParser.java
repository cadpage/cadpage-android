package net.anei.cadpage.parsers.NC;

import net.anei.cadpage.parsers.MsgInfo.Data;
import net.anei.cadpage.parsers.dispatch.DispatchOSSIParser;

/* 
Union County, NC
Contact: David Bruce <dbruce0571@gmail.com>
Sender: cad@uc.co.union.nc.us

CAD:3711 WHITE STORE RD;WINGATE;OUTSIDE FIRE;S09;WITMORE RD;NASH RD;02/15/2011 13:21:38
CAD:3812 E HWY 74;WINGATE;SICK PERSON EMD;S09;FX-CF2;BIVENS ST;N STEWART ST;02/18/2011 16:03:05;FOOD LION WINGATE

Contact: James Murray <jmurray1555@gmail.com>
Sender: CAD@co.union.nc.us
CAD:3626 HAYES RD;INDIAN TRAIL;BREATHING PROBLEMS EMD;S19;BR-2;OLD CHARLOTTE HWY;OLD CHARLOTTE HWY;09/26/2011 19:37:34

Contact: Scott Kimrey <skimrey@windstream.net>
Sender: CAD@co.union.nc.us
CAD:604 SUNSET ST;MARSHVILLE;STRUCTURE FIRE EFD;CFD;S08

Contact: Active911
Agency name: Monroe Police Department Location: Monroe, NC 
Sender: CAD@co.union.nc.us  

CAD:FYI: ;2300-E W ROOSEVELT BLVD;MONROE;ACCIDENT EMD;MPD;M1;JERSEY MIKES
CAD:FYI: ;1614 NAZARETH CT;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M1
CAD:FYI: ;311 E JEFFERSON ST;MONROE;ROBBERY BY THREATS OF VIOLENCE;MPD;M4;UNION COUNTY COMMUNITY SHELTER
CAD:FYI: ;723 N CHARLOTTE AV;MONROE;FLOOD REPORT;MPD;M2;JBS MIDWAY BBQ
CAD:FYI: ;3199 WALKUP AV/MASON ST;MONROE;ACCIDENT EMD;MPD;M3
CAD:Update: ;799 LANCASTER AV/S JOHNSON ST;MONROE;ARMED SUBJECT REPORT;MPD;M2
CAD:Update: ;801 LANCASTER AV;MONROE;ARMED SUBJECT REPORT;MPD;M2;BP GAS NO 3 LANCASTER AV
CAD:FYI: ;1109 PARKER ST;MONROE;DRUG ACTIVITY IN PROGRESS;MPD;M4
CAD:FYI: ;3999 GOLDMINE RD/SANFORD LN;MONROE;ACCIDENT EMD;MPD;M1
CAD:FYI: ;1399 AIRPORT RD/CORPORATE CENTER DR;MONROE;FLOOD REPORT;MPD;M1
CAD:FYI: ;218 E FRANKLIN ST;MONROE;MISSING PERSON;MPD;M4;MONROE PD
CAD:FYI: ;2529 CARROLL ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M1
CAD:FYI: ;799 MAURICE ST/E SUNSET DR;MONROE;VEHICLE OR FOOT PURSUIT;MPD;CIT3
CAD:FYI: ;601-B FIRST ST;MONROE;DRUG ACTIVITY IN PROGRESS;MPD;CIT2
CAD:FYI: ;2705 WALKUP AV;MONROE;ARMED SUBJECT REPORT;MPD;M3;TAQUERIA MEXICO LINDO REST
CAD:FYI: ;2014 CONFEDERATE ST;MONROE;ARMED SUBJECT REPORT;MPD;CIT1
CAD:FYI: ;2300-AB W ROOSEVELT BLVD;MONROE;ACCIDENT EMD;MPD;M1;TUMBLEWEEDS
CAD:FYI: ;1904 STEELE ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M3
CAD:FYI: ;2198 W ROOSEVELT BLVD/DICKERSON BLVD;MONROE;ACCIDENT EMD;MPD;M1
CAD:FYI: ;1212 W ROOSEVELT BLVD;MONROE;SEX ASSAULT CHILD LAW;MPD;M3;UNION COUNTY DSS
CAD:Update: ;605 WHORE;SEX ASSAULT CHILD LAW;07/23/2012 15:53:30
CAD:Update: ;605 WORLEY ST;MONROE;SEX ASSAULT CHILD LAW;MPD;CIT3
CAD:Update: ;2701 WALKUP AV;MONROE;DRUG ACTIVITY IN PROGRESS;MPD;M3;SUTTON PARK GROCERY
CAD:FYI: ;2701 WALKUP AV;MONROE;DRUG ACTIVITY IN PROGRESS;MPD;M3;SUTTON PARK GROCERY
CAD:FYI: ;318 W FRANKLIN ST;MONROE;BURGLARY COMMERCIAL BUSINESS;MPD;M2
CAD:Update: ;318 E FRANKLIN ST;MONROE;BURGLARY COMMERCIAL BUSINESS;MPD;M4;RANCHERO GRANDE
CAD:FYI: ;14298 E INDEPENDENCE BLVD/UNIONVILLE INDIAN TRAIL RD;INDIAN TRAIL;ACCIDENT MULT VICTIMS VEHICLES;UEMS;ST51
CAD:FYI: ;3223 WALKUP AV;MONROE;WEAPONS FIREARMS INCIDENTS;MPD;CIT1;WILLOW OAKS APARTMENTS
CAD:Update: ;3223-10A WALKUP AV;MONROE;WEAPONS FIREARMS INCIDENTS;MPD;CIT1
CAD:FYI: ;418 E FRANKLIN ST;MONROE;BURGLARY COMMERCIAL BUSINESS;MPD;CIT3;YOUTH WITH A MISSION
CAD:FYI: ;4411 MYERS RD;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M1
CAD:FYI: ;3223 WALKUP AV;MONROE;DRUG ACTIVITY IN PROGRESS;MPD;CIT1;WILLOW OAKS APARTMENTS
CAD:FYI: ;1616 BATTLE LN;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M1
CAD:Update: ;913 LASALLE ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;CIT2
CAD:Update: ;399 E GREEN ST/MAURICE ST;MONROE;MISSING PERSON;MPD;CIT3
CAD:Update: ;399 E GREEN ST/MAURICE ST;MONROE;ATTEMPT TO LOCATE;M4;CIT3;07/27/2012 01:13:07
CAD:FYI: ;499 WALNUT ST/CONCORD AV;MONROE;ACCIDENT EMD;MPD;M2
CAD:FYI: ;499 S HAYNE ST/E HOUSTON ST;MONROE;ACCIDENT EMD;MPD;M4
CAD:FYI: ;1909 LEXINGTON AV;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M2
CAD:Update: ;1909 LEXINGTON AV;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M2
CAD:FYI: ;1111 CIRCLE DR;MONROE;BURGLARY COMMERCIAL BUSINESS;MPD;M4;CIRCLE MEDICAL ASSOCIATES
CAD:Update: ;2106 WALKUP AV;MONROE;SEX ASSAULT ADULT LAW;MPD;CIT1
CAD:FYI: ;709 ENGLISH ST;MONROE;MISSING PERSON;MPD;CIT2
CAD:Update: ;709 ENGLISH ST;MONROE;LOST OR FOUND PROPERTY;M4;CIT2;JEROME ST;MASSEY ST;07/28/2012 08:58:40
CAD:FYI: ;404 VICTORIA AV;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M2
CAD:Update: ;2117 LONGS TRAILER PARK RD;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M1
CAD:FYI: ;313 CULPEPPER ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M4
CAD:FYI: ;1423-F E FRANKLIN ST;MONROE;SUICIDAL THREAT EPD;MPD;M4;UNION PRIMARY CARE
CAD:FYI: ;320 E GREEN ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;CIT3
CAD:Update: ;1718-A ICEMORLEE ST;MONROE;ARMED SUBJECT REPORT;MPD;CIT4
CAD:FYI: ;1007 WALTERS ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M2;ABC PRINTING
CAD:Update: ;Q1007 WALTERS ST;BURGLARY HOME OTHER NONBUSNESS;MPD
CAD:Update: ;1007 WALTERS ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M2;ABC PRINTING
CAD:FYI: ;1127-B PARKER ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;M2
CAD:FYI: ;2336 W ROOSEVELT BLVD;MONROE;ACCIDENT EMD;MPD;M1;LOGANS ROADHOUSE GRILL
CAD:FYI: ;1727-D ICEMORLEE ST;MONROE;BURGLARY HOME OTHER NONBUSNESS;MPD;CIT4
CAD:FYI: ;511-BLK E HUDSON ST;MONROE;ARMED SUBJECT REPORT;MPD;CIT3
CAD:FYI: ;HUDSON ST;SHOTS FIRED SEEN UNSEEN;MPD
CAD:FYI: ;200 HOUGH ST/E FRANKLIN ST;MONROE;ARMED SUBJECT REPORT;MPD;M4
CAD:CANCEL;200 HOUGH ST/E FRANKLIN ST; MON
CAD:FYI: ;121 MAPLE HILL RD;MONROE;MISSING PERSON;MPD;M2
CAD:Update: ;318-BLK E HUDSON ST;MONROE;SHOTS FIRED SEEN UNSEEN;MPD;CIT3
CAD:FYI: ;1600 E ROOSEVELT BLVD;MONROE;ACCIDENT EMD;MPD;M4;JACK IN THE BOX

*/

public class NCUnionCountyParser extends DispatchOSSIParser {
  
  public NCUnionCountyParser() {
    super(CITY_LIST, "UNION COUNTY", "NC",
           "( CANCEL ADDR CITY? | FYI? ADDR CITY? CALL ) SRC? UNIT? INFO+? DATETIME PLACE");
  }
  
  @Override
  public String getFilter() {
    return "cad@uc.co.union.nc.us,cad@webmail.co.union.nc.us,cad@co.union.nc.us";
  }
  
  private class MyInfoField extends InfoField {
    @Override
    public void parse(String field, Data data) {
      if (checkAddress(field) > 0) {
        data.strCross = append(data.strCross, " & ", field);
      } else if (data.strPlace.length() == 0) {
        data.strPlace = field;
      } else {
        data.strSupp = append(data.strSupp, " / ", field);
      }
    }
    
    @Override
    public String getFieldNames() {
      return "X PLACE INFO";
    }
  }
  
  @Override
  protected Field getField(String name) {
    if (name.equals("CANCEL")) return new CallField("CANCEL");
    if (name.equals("SRC")) return new SourceField("[A-Z0-9]{2,4}", true);
    if (name.equals("UNIT")) return new UnitField("[A-Z0-9]{2,4}(?:-[A-Z0-9]{1,4})?", true);
    if (name.equals("INFO")) return new MyInfoField();
    if (name.equals("DATETIME")) return new DateTimeField("\\d\\d/\\d\\d/\\d{4} \\d\\d:\\d\\d:\\d\\d");
    return super.getField(name);
  }
  
  private static final String[] CITY_LIST = new String[]{
    "FAIRVIEW",
    "HEMBY BRIDGE",
    "INDIAN TRAIL",
    "LAKE PARK",
    "MARSHVILLE",
    "MARVIN",
    "MINERAL SPRINGS",
    "MONROE",
    "STALLINGS",
    "UNIONVILLE",
    "WAXHAW",
    "WEDDINGTON",
    "WESLEY CHAPEL",
    "WINGATE"
  };
}
