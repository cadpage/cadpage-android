package net.anei.cadpage.parsers.TX;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

import net.anei.cadpage.parsers.MsgInfo.Data;
import net.anei.cadpage.parsers.MsgParser;

/* 
Hays County, TX
Contact: Active911
Agency name: North Hays County Fire and Rescue ESD6 Location: Dripping Springs, TX 
Sender: dispatch@smhcems.com

(Alarm - ESD6FIRE - SEIZURES) ESD6 RESPOND TO 14030 N GREEN HILLS LOOP FOR SEIZURES DET CODE: 12D02
(Alarm - ESD6FIRE - HEMORRHAGE / LAC) ESD6 RESPOND TO 1150 ENCHANTED OAKS DR FOR HEMORRHAGE / LAC DET CODE: 21B01
(Alarm - ESD6FIRE - BREATHING PROBLEMS) ESD6 RESPOND TO 191 CANTERBURY DR [AUSTIN FOR BREATHING PROBLEMS DET CODE: 06D02
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 1505 W US 290 FOR FALLS DET CODE: €
(Alarm - ESD6FIRE - HEART PROBLEMS) ESD6 RESPOND TO 16719 FITZHUGH RD [DRIPPING SPRINGS FOR HEART PROBLEMS DET CODE: 19D04
(Alarm - ESD6FIRE - EDP) ESD6 RESPOND TO 400 OLD HIGHWAY 290 FOR EDP DET CODE: 25D01
(Alarm - ESD6FIRE - FUEL SPILL) ESD6 RESPOND TO 2000 E US 290 [DRIPPING SPRINGS FOR FUEL SPILL DET CODE: 59B01
(Alarm - ESD6FIRE - SICK PERSON) ESD6 RESPOND TO 100 BOLTON DR FOR SICK PERSON DET CODE: 26C02
(Alarm - ESD6FIRE - SICK PERSON) ESD6 RESPOND TO 1027 S SUNSET CANYON DR FOR SICK PERSON DET CODE: 26A05
(Alarm - ESD6FIRE - ABDOMINAL PAIN) ESD6 RESPOND TO 289 SPRINGS LN [DRIPPING SPRINGS FOR ABDOMINAL PAIN DET CODE: 01A01
(Alarm - ESD6FIRE - PUBLIC ASSIST) ESD6 RESPOND TO 1601 BELL SPRINGS RD [DRIPPING SPRINGS FOR PUBLIC ASSIST DET CODE: €
(Alarm - ESD6FIRE - ABDOMINAL PAIN) ESD6 RESPOND TO 1300 W US 290 FOR ABDOMINAL PAIN DET CODE: 01A01
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO MHWY 290 & RETHA DR FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO W RR 150 & RR 1826 [DRIFTWOOD FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - FUEL SPILL) ESD6 RESPOND TO 598 E US 290 [DRIPPING SPRINGS FOR FUEL SPILL DET CODE: 59C04O
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 18300 RR 1826 [DRIFTWOOD FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - SEIZURES) ESD6 RESPOND TO 410 COOL SPRING WAY [AUSTIN FOR SEIZURES DET CODE: 12B01
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 301 BUTLER RANCH RD [DRIPPING SPRINGS FOR FALLS DET CODE: €
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 195 CORK LN FOR FALLS DET CODE: 17B01G
(Alarm - ESD6FIRE - MEDICAL PREEMPT) ESD6 RESPOND TO 395 RAMIREZ LN FOR MEDICAL PREEMPT DET CODE: €
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO BARSANA RD & RR 1826 [AUSTIN FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - ALARMS / FIRE) ESD6 RESPOND TO 799 ONION CREEK RANCH RD [DRIFTWOOD FOR ALARMS / FIRE DET CODE: 52B01
(Alarm - ESD6FIRE - VEHICLE FIRE) ESD6 RESPOND TO 32901 RR 12 [DRIPPING SPRINGS FOR VEHICLE FIRE DET CODE: €
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 1600 E US 290 [DRIPPING SPRINGS FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - BACK PAIN) ESD6 RESPOND TO 591 WILD ROSE DR FOR BACK PAIN DET CODE: €
(Alarm - ESD6FIRE - AGENCY ASSIST / L.E.) ESD6 RESPOND TO 18301 RR 1826 [DRIFTWOOD FOR AGENCY ASSIST / L.E. DET CODE: ASSAULT
(Alarm - ESD6FIRE - SICK PERSON) ESD6 RESPOND TO 400 SPORTSPLEX [DRIPPING SPRINGS FOR SICK PERSON DET CODE: 26A01
(Alarm - ESD6FIRE - CHEST PAIN) ESD6 RESPOND TO 301 BARTON CREEK DR [DRIPPING SPRINGS FOR CHEST PAIN DET CODE: 10D03
(Alarm - ESD6FIRE - EDP) ESD6 RESPOND TO 450 TORRINGTON DR [AUSTIN FOR EDP DET CODE: 25B06V
(Alarm - ESD6FIRE - TRANSFER) ESD6 RESPOND TO 800 W US 290 FOR TRANSFER DET CODE: 33C02T
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO W US 290 & WHIRLAWAY [AUSTIN FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 1335 TREBBLED WATERS TRL FOR FALLS DET CODE: €
(Alarm - ESD6FIRE - BREATHING PROBLEMS) ESD6 RESPOND TO 400 SPORTSPLEX [DRIPPING SPRINGS FOR BREATHING PROBLEMS DET CODE: 06C01
(Alarm - ESD6FIRE - TRAUMATIC INJURIES) ESD6 RESPOND TO 27216 RR 12 [DRIPPING SPRINGS FOR TRAUMATIC INJURIES DET CODE: 30A01
(Alarm - ESD6FIRE - SEIZURES) ESD6 RESPOND TO 14710 CROSS CREEK DR [AUSTIN FOR SEIZURES DET CODE: €
(Alarm - ESD6FIRE - PUBLIC ASSIST) ESD6 RESPOND TO 100 GLOSSON RD [DRIPPING SPRINGS FOR PUBLIC ASSIST DET CODE: 53A01
(Alarm - ESD6FIRE - BREATHING PROBLEMS) ESD6 RESPOND TO 1200 MONTELL RD [WIMBERLEY FOR BREATHING PROBLEMS DET CODE: €
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 13070 FIELDSTONE LOOP [AUSTIN FOR FALLS DET CODE: 17A02
(Alarm - ESD6FIRE - ALARMS / FIRE) ESD6 RESPOND TO 112 KNOLL CV FOR ALARMS / FIRE DET CODE: €
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 1000 BROWNSON LN [DRIFTWOOD FOR FALLS DET CODE: €
(Alarm - ESD6FIRE - MEDICAL PREEMPT) ESD6 RESPOND TO 598 E US 290 [DRIPPING SPRINGS FOR MEDICAL PREEMPT DET CODE: €
(Alarm - ESD6FIRE - BREATHING PROBLEMS) ESD6 RESPOND TO 810 OLD RED RANCH RD FOR BREATHING PROBLEMS DET CODE: 06D02
(Alarm - ESD6FIRE - SICK PERSON) ESD6 RESPOND TO 18300 RR 1826 [DRIFTWOOD FOR SICK PERSON DET CODE: 26A06
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 300 WOODS LOOP [DRIFTWOOD FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - AGENCY ASSIST / L.E.) ESD6 RESPOND TO 304 HARMON HILLS CV [DRIPPING SPRINGS FOR AGENCY ASSIST / L.E. DET CODE: ASSAULT
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO W FITZHUGH RD & BELL SPRINGS RD [DRIPPING SPRINGS FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - VEHICLE FIRE) ESD6 RESPOND TO E US 290 & RR 12 [DRIPPING SPRINGS FOR VEHICLE FIRE DET CODE: 71A01
(Alarm - ESD6FIRE - AGENCY ASSIST/FIRE) ESD6 RESPOND TO 16219 CHRISTAL CAVE DR [AUSTIN FOR AGENCY ASSIST/FIRE DET CODE: €
(Alarm - ESD6FIRE - SMOKE INVESTIGATION) ESD6 RESPOND TO N CANYONWOOD DR & OAKWOOD LN [DRIPPING SPRINGS FOR SMOKE INVESTIGATION DET CODE: €
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO 12011 TRAUTWEIN RD [AUSTIN FOR MVA DET CODE: €
(Alarm - ESD6FIRE - EXPLOSION) ESD6 RESPOND TO 208 GATLIN CREEK RD FOR EXPLOSION DET CODE: €
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 18300 RR 1826 FOR FALLS DET CODE: 17B03G
(Alarm - ESD6FIRE - ALARMS / FIRE) ESD6 RESPOND TO 14521 FRIENDSWOOD LN [AUSTIN FOR ALARMS / FIRE DET CODE: €
(Alarm - ESD6FIRE - CHEST PAIN) ESD6 RESPOND TO 27495 RR 12 [DRIPPING SPRINGS FOR CHEST PAIN DET CODE: 10D01
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO 1432 E US 290 FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - ALLERGIES / BITES) ESD6 RESPOND TO 289 SPRINGS LN [DRIPPING SPRINGS FOR ALLERGIES / BITES DET CODE: 02D02
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO W US 290 & SAWYER RANCH RD [AUSTIN/DRIPPING SPRINGS FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - AGENCY ASSIST/FIRE) ESD6 RESPOND TO 23610 HAMILTON POOL RD [TC FOR AGENCY ASSIST/FIRE DET CODE: €
(Alarm - ESD6FIRE - STRUCTURE FIRE) ESD6 RESPOND TO 200 FAWN MEADOW DR [DRIPPING SPRINGS FOR STRUCTURE FIRE DET CODE: €
(Alarm - ESD6FIRE - DIABETIC PROBLEMS) ESD6 RESPOND TO 309 SUNDANCE TRL FOR DIABETIC PROBLEMS DET CODE: €
(Alarm - ESD6FIRE - EDP) ESD6 RESPOND TO 450 TORRINGTON DR [AUSTIN FOR EDP DET CODE: 25A01
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 7071 W US 290 FOR FALLS DET CODE: 17B01G
(Alarm - ESD6FIRE - AGENCY ASSIST / L.E.) ESD6 RESPOND TO 700 OLD FITZHUGH RD [DRIPPING SPRINGS FOR AGENCY ASSIST / L.E. DET CODE: Advised
(Alarm - ESD6FIRE - SMOKE INVESTIGATION) ESD6 RESPOND TO 1243 CANYON VIEW RD FOR SMOKE INVESTIGATION DET CODE: €
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO 222 W US 290 FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO 16982 RR 1826 FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO MCGREGOR LN & W US 290 [DRIPPING SPRINGS FOR MVA DET CODE: €
(Alarm - ESD6FIRE - BREATHING PROBLEMS) ESD6 RESPOND TO 100 GLOSSON RD [DRIPPING SPRINGS FOR BREATHING PROBLEMS DET CODE: 06D01
(Alarm - ESD6FIRE - CHEST PAIN) ESD6 RESPOND TO 111 SAINT RICHIE LN FOR CHEST PAIN DET CODE: 10D04
(Alarm - ESD6FIRE - SICK PERSON) ESD6 RESPOND TO 410 TORRINGTON DR FOR SICK PERSON DET CODE: 26A05
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 18301 RR 1826 [AUSTIN [DRIFTWOOD FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - TRAUMATIC INJURIES) ESD6 RESPOND TO 260 E US 290 [DRIPPING SPRINGS FOR TRAUMATIC INJURIES DET CODE: 30A01
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO RR 1826 & CAMP BEN MCCULLOCH [DRIFTWOOD FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO RR 1826 & CAMP BEN MCCULLOCH [DRIFTWOOD FOR MVA DET CODE: 11MAJOR
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO 20600 RR 12 [DRIFTWOOD FOR MVA DET CODE: 29B01
(Alarm - ESD6FIRE - CARDIAC  ARREST) ESD6 RESPOND TO 200 MEADOW OAKS DR FOR CARDIAC  ARREST DET CODE: €
(Alarm - ESD6FIRE - PUBLIC ASSIST) ESD6 RESPOND TO 14105 FITZHUGH RD [TC FOR PUBLIC ASSIST DET CODE: €
(Alarm - ESD6FIRE - BREATHING PROBLEMS) ESD6 RESPOND TO 289 SPRINGS LN FOR BREATHING PROBLEMS DET CODE: €
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 6910 W FITZHUGH RD FOR FALLS DET CODE: 17A01G
(Alarm - ESD6FIRE - AGENCY ASSIST / L.E.) ESD6 RESPOND TO 211 DARDEN HILL RD [DRIFTWOOD FOR AGENCY ASSIST / L.E. DET CODE: ASSAULT
(Alarm - ESD6FIRE - FALLS) ESD6 RESPOND TO 5845 MT GAINOR RD [DRIPPING SPRINGS FOR FALLS DET CODE: €
(Alarm - ESD6FIRE - MEDICAL PREEMPT) ESD6 RESPOND TO 598 E US 290 [DRIPPING SPRINGS FOR MEDICAL PREEMPT DET CODE: €
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 353 S OAK FOREST DR FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - BREATHING PROBLEMS) ESD6 RESPOND TO 9001 MCGREGOR LN [DRIPPING SPRINGS FOR BREATHING PROBLEMS DET CODE: €
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 759 BELL SPRINGS RD [DRIPPING SPRINGS FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - HEART PROBLEMS) ESD6 RESPOND TO 160 ABBOTT DR FOR HEART PROBLEMS DET CODE: €
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 139 TERRACE CT FOR OUTSIDE FIRE DET CODE: 67D02R
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 250 OPEN SKY RD FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO DAISY LN & BELL SPRINGS FOR OUTSIDE FIRE DET CODE: €
(Alarm - ESD6FIRE - ALARMS / FIRE) ESD6 RESPOND TO 1401 CANONADE [AUSTIN FOR ALARMS / FIRE DET CODE: €
(Alarm - ESD6FIRE - TRAUMATIC INJURIES) ESD6 RESPOND TO PEMBERTON WAY [AUSTIN FOR TRAUMATIC INJURIES DET CODE: 30B02
(Alarm - ESD6FIRE - BURN BAN VIOLATION) ESD6 RESPOND TO 400 ELDER HILL RD [DRIFTWOOD FOR BURN BAN VIOLATION DET CODE: €
(Alarm - ESD6FIRE - PUBLIC ASSIST) ESD6 RESPOND TO 14455 RR 1826 [AUSTIN FOR PUBLIC ASSIST DET CODE: €
(Alarm - ESD6FIRE - TRAUMATIC INJURIES) ESD6 RESPOND TO 120 HARRIS DR FOR TRAUMATIC INJURIES DET CODE: €
(Alarm - ESD6FIRE - OUTSIDE FIRE) ESD6 RESPOND TO 600 CANYON RIM DR [DRIPPING SPRINGS FOR OUTSIDE FIRE DET CODE: 67A01
(Alarm - ESD6FIRE - UNCONSCIOUS) ESD6 RESPOND TO 13000 W US 290 FOR UNCONSCIOUS DET CODE: €
(Alarm - ESD6FIRE - ALLERGIES / BITES) ESD6 RESPOND TO 400 SPORTSPLEX [DRIPPING SPRINGS FOR ALLERGIES / BITES DET CODE: €
(Alarm - ESD6FIRE - MVA) ESD6 RESPOND TO 8651 W FITZHUGH RD FOR MVA DET CODE: €

*/

public class TXHaysCountyParser extends MsgParser {
  
  private static final Pattern SUBJECT_PTN = Pattern.compile("Alarm - (.*?) - (.*)");
  private static final Pattern MASTER = Pattern.compile("([A-Z0-9]+) RESPOND TO (.*?) (?:\\[(.*) )?FOR (.*?) DET CODE: (.*?)");
  
  public TXHaysCountyParser() {
    super("HAYS COUNTY", "TX");
  }
  
  public String getFilter() {
    return "dispatch@smhcems.com";
  }
  
  @Override
  protected boolean parseMsg(String subject, String body, Data data) {
    Matcher match = SUBJECT_PTN.matcher(subject);
    if (!match.matches()) return false;
    data.strSource = match.group(1).trim();
    data.strCall = match.group(2).trim();
    
    match = MASTER.matcher(body);
    if (!match.matches()) return false;
    data.strUnit = match.group(1).trim();
    parseAddress(match.group(2).trim(), data);
    data.strCity = getOptGroup(match.group(3));
    data.strCall = match.group(4).trim();
    data.strCode = match.group(5).trim();
    if (data.strCode.length() < 2) data.strCode = "";
    return true;
  }

  @Override
  public String adjustMapAddress(String sAddress) {
    return RR_PTN.matcher(sAddress).replaceAll("RT");
  }
  private static final Pattern RR_PTN = Pattern.compile("\\bRR\\b");
}
