package net.anei.cadpage.parsers.MN;

import java.util.Properties;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import net.anei.cadpage.parsers.MsgInfo.Data;
import net.anei.cadpage.parsers.dispatch.DispatchA13Parser;



public class MNWrightCountyParser extends DispatchA13Parser {
  
  private static final Pattern COUNTY_PTN = Pattern.compile("(.*?)[ -]+(HENNE|STEARNS)", Pattern.CASE_INSENSITIVE);
  
  public MNWrightCountyParser() {
    super("WRIGHT COUNTY", "MN");
    setupGpsLookupTable(GPS_LOOKUP_TABLE);
  }

  @Override
  protected boolean parseMsg(String body, Data data) {
    if (!super.parseMsg(body, data)) return false;
    
    if (data.strPlace.startsWith("MM ")) {
      data.strAddress = append(data.strAddress, " ", data.strPlace);
      data.strPlace = "";
    }
    
    Matcher match = COUNTY_PTN.matcher(data.strAddress);
    if (match.matches()) {
      data.strAddress = match.group(1);
      if (data.strCity.length() == 0) {
        String county =  match.group(2).toUpperCase();
        if (county.equals("HENNE")) county = "HENNEPIN";
        data.strCity =  county + " COUNTY";
      }
    }
    return true;
  }
  
  private static final Properties GPS_LOOKUP_TABLE = buildCodeTable(new String[]{
      "I94 MM 178 EB",  "45.414036,-94.063359",
      "I94 MM 179 EB",  "45.405561,-94.045415",
      "I94 MM 180 EB",  "45.396917,-94.029264",
      "I94 MM 181 EB",  "45.388094,-94.013355",
      "I94 MM 182 EB",  "45.377869,-94.000067",
      "I94 MM 183 EB",  "45.369555,-93.983502",
      "I94 MM 184 EB",  "45.366355,-93.962515",
      "I94 MM 185 EB",  "45.360470,-93.944291",
      "I94 MM 186 EB",  "45.354719,-93.926012",
      "I94 MM 187 EB",  "45.350986,-93.906437",
      "I94 MM 188 EB",  "45.344711,-93.888545",
      "I94 MM 189 EB",  "45.337132,-93.871790",
      "I94 MM 190 EB",  "45.329639,-93.854553",
      "I94 MM 191 EB",  "45.319559,-93.839995",
      "I94 MM 192 EB",  "45.310471,-93.824742",
      "I94 MM 193 EB",  "45.300472,-93.810109",
      "I94 MM 194 EB",  "45.296259,-93.787868",
      "I94 MM 195 EB",  "45.290326,-93.769474",
      "I94 MM 196 EB",  "45.284371,-93.751853",
      "I94 MM 197 EB",  "45.275275,-93.736310",
      "I94 MM 198 EB",  "45.266362,-93.719891",
      "I94 MM 199 EB",  "45.257493,-93.703664",
      "I94 MM 200 EB",  "45.249629,-93.686440",
      "I94 MM 201 EB",  "45.242584,-93.668418",
      "I94 MM 202 EB",  "45.237933,-93.649080",
      "I94 MM 203 EB",  "45.230384,-93.632309",
      "I94 MM 204 EB",  "45.226653,-93.613248",
      "I94 MM 205 EB",  "45.219564,-93.598635",
      "I94 MM 206 EB",  "45.216804,-93.594077",
      
      "I94 MM 178 WB",  "45.414036,-94.063359",
      "I94 MM 179 WB",  "45.405561,-94.045415",
      "I94 MM 180 WB",  "45.396917,-94.029264",
      "I94 MM 181 WB",  "45.388094,-94.013355",
      "I94 MM 182 WB",  "45.377869,-94.000067",
      "I94 MM 183 WB",  "45.369555,-93.983502",
      "I94 MM 184 WB",  "45.366355,-93.962515",
      "I94 MM 185 WB",  "45.360470,-93.944291",
      "I94 MM 186 WB",  "45.354719,-93.926012",
      "I94 MM 187 WB",  "45.350986,-93.906437",
      "I94 MM 188 WB",  "45.344711,-93.888545",
      "I94 MM 189 WB",  "45.337132,-93.871790",
      "I94 MM 190 WB",  "45.329639,-93.854553",
      "I94 MM 191 WB",  "45.319559,-93.839995",
      "I94 MM 192 WB",  "45.310471,-93.824742",
      "I94 MM 193 WB",  "45.300472,-93.810109",
      "I94 MM 194 WB",  "45.296259,-93.787868",
      "I94 MM 195 WB",  "45.290326,-93.769474",
      "I94 MM 196 WB",  "45.284371,-93.751853",
      "I94 MM 197 WB",  "45.275275,-93.736310",
      "I94 MM 198 WB",  "45.266362,-93.719891",
      "I94 MM 199 WB",  "45.257493,-93.703664",
      "I94 MM 200 WB",  "45.249629,-93.686440",
      "I94 MM 201 WB",  "45.242584,-93.668418",
      "I94 MM 202 WB",  "45.237933,-93.649080",
      "I94 MM 203 WB",  "45.230384,-93.632309",
      "I94 MM 204 WB",  "45.226653,-93.613248",
      "I94 MM 205 WB",  "45.219564,-93.598635",
      "I94 MM 206 WB",  "45.216804,-93.594077",

      
      "US10 MM 214 EB",  "45.295023,-93.559635",
      "US10 MM 214 WB",  "45.295023,-93.559635",

      
      "US12 MM 115 EB",  "45.080619,-94.248925",
      "US12 MM 116 EB",  "45.080335,-94.228290",
      "US12 MM 117 EB",  "45.080087,-94.208059",
      "US12 MM 118 EB",  "45.079988,-94.187367",
      "US12 MM 119 EB",  "45.071157,-94.172464",
      "US12 MM 120 EB",  "45.065135,-94.155420",
      "US12 MM 121 EB",  "45.065171,-94.136193",
      "US12 MM 122 EB",  "45.065327,-94.115579",
      "US12 MM 123 EB",  "45.065395,-94.094674",
      "US12 MM 124 EB",  "45.060694,-94.076084",
      "US12 MM 125 EB",  "45.062221,-94.055980",
      "US12 MM 126 EB",  "45.064130,-94.035142",
      "US12 MM 127 EB",  "45.064201,-94.014470",
      "US12 MM 128 EB",  "45.064414,-93.994310",
      "US12 MM 129 EB",  "45.064704,-93.974374",
      "US12 MM 130 EB",  "45.065408,-93.953887",
      "US12 MM 131 EB",  "45.065109,-93.933562",
      "US12 MM 132 EB",  "45.064899,-93.913089",
      "US12 MM 133 EB",  "45.064874,-93.892751",
      "US12 MM 134 EB",  "45.064913,-93.872097",
      "US12 MM 135 EB",  "45.064930,-93.851636",
      "US12 MM 136 EB",  "45.064853,-93.831404",
      "US12 MM 137 EB",  "45.063530,-93.810443",
      "US12 MM 138 EB",  "45.051351,-93.801022",
      "US12 MM 139 EB",  "45.040022,-93.791415",
      "US12 MM 140 EB",  "45.035518,-93.776257",
      
      "US12 MM 115 WB",  "45.080619,-94.248925",
      "US12 MM 116 WB",  "45.080335,-94.228290",
      "US12 MM 117 WB",  "45.080087,-94.208059",
      "US12 MM 118 WB",  "45.079988,-94.187367",
      "US12 MM 119 WB",  "45.071157,-94.172464",
      "US12 MM 120 WB",  "45.065135,-94.155420",
      "US12 MM 121 WB",  "45.065171,-94.136193",
      "US12 MM 122 WB",  "45.065327,-94.115579",
      "US12 MM 123 WB",  "45.065395,-94.094674",
      "US12 MM 124 WB",  "45.060694,-94.076084",
      "US12 MM 125 WB",  "45.062221,-94.055980",
      "US12 MM 126 WB",  "45.064130,-94.035142",
      "US12 MM 127 WB",  "45.064201,-94.014470",
      "US12 MM 128 WB",  "45.064414,-93.994310",
      "US12 MM 129 WB",  "45.064704,-93.974374",
      "US12 MM 130 WB",  "45.065408,-93.953887",
      "US12 MM 131 WB",  "45.065109,-93.933562",
      "US12 MM 132 WB",  "45.064899,-93.913089",
      "US12 MM 133 WB",  "45.064874,-93.892751",
      "US12 MM 134 WB",  "45.064913,-93.872097",
      "US12 MM 135 WB",  "45.064930,-93.851636",
      "US12 MM 136 WB",  "45.064853,-93.831404",
      "US12 MM 137 WB",  "45.063530,-93.810443",
      "US12 MM 138 WB",  "45.051351,-93.801022",
      "US12 MM 139 WB",  "45.040022,-93.791415",
      "US12 MM 140 WB",  "45.035518,-93.776257",

      
      "MN24 MM 031 NB",  "45.265499,-94.124469",
      "MN24 MM 032 NB",  "45.273316,-94.111176",
      "MN24 MM 033 NB",  "45.282651,-94.104335",
      "MN24 MM 034 NB",  "45.279061,-94.086127",
      "MN24 MM 035 NB",  "45.291110,-94.079773",
      "MN24 MM 036 NB",  "45.302771,-94.090932",
      "MN24 MM 037 NB",  "45.317237,-94.090814",
      "MN24 MM 038 NB",  "45.331659,-94.091519",
      "MN24 MM 039 NB",  "45.344410,-94.082071",
      "MN24 MM 040 NB",  "45.355904,-94.071527",
      "MN24 MM 041 NB",  "45.370136,-94.069818",
      "MN24 MM 042 NB",  "45.384226,-94.066132",
      "MN24 MM 043 NB",  "45.397782,-94.061624",
      "MN24 MM 044 NB",  "45.411981,-94.057666",
      
      "MN24 MM 031 SB",  "45.265499,-94.124469",
      "MN24 MM 032 SB",  "45.273316,-94.111176",
      "MN24 MM 033 SB",  "45.282651,-94.104335",
      "MN24 MM 034 SB",  "45.279061,-94.086127",
      "MN24 MM 035 SB",  "45.291110,-94.079773",
      "MN24 MM 036 SB",  "45.302771,-94.090932",
      "MN24 MM 037 SB",  "45.317237,-94.090814",
      "MN24 MM 038 SB",  "45.331659,-94.091519",
      "MN24 MM 039 SB",  "45.344410,-94.082071",
      "MN24 MM 040 SB",  "45.355904,-94.071527",
      "MN24 MM 041 SB",  "45.370136,-94.069818",
      "MN24 MM 042 SB",  "45.384226,-94.066132",
      "MN24 MM 043 SB",  "45.397782,-94.061624",
      "MN24 MM 044 SB",  "45.411981,-94.057666",

      "MN25 MM 042 NB",  "44.977891,-93.887473",
      "MN25 MM 043 NB",  "44.989690,-93.899324",
      "MN25 MM 044 NB",  "45.005054,-93.900190",
      "MN25 MM 045 NB",  "45.016511,-93.908419",
      "MN25 MM 046 NB",  "45.030498,-93.910278",
      "MN25 MM 047 NB",  "45.044948,-93.910643",
      "MN25 MM 048 NB",  "45.059422,-93.910910",
      "MN25 MM 051 NB",  "45.072493,-93.868989",
      "MN25 MM 052 NB",  "45.086995,-93.868905",
      "MN25 MM 053 NB",  "45.101395,-93.868882",
      "MN25 MM 054 NB",  "45.115806,-93.868333",
      "MN25 MM 055 NB",  "45.130518,-93.868628",
      "MN25 MM 056 NB",  "45.144475,-93.868375",
      "MN25 MM 057 NB",  "45.158984,-93.868223",
      "MN25 MM 058 NB",  "45.171673,-93.876267",
      "MN25 MM 059 NB",  "45.186306,-93.876175",
      "MN25 MM 060 NB",  "45.199299,-93.869013",
      "MN25 MM 061 NB",  "45.209979,-93.856580",
      "MN25 MM 062 NB",  "45.222911,-93.847982",
      "MN25 MM 063 NB",  "45.237285,-93.847137",
      "MN25 MM 064 NB",  "45.251691,-93.834778",
      "MN25 MM 065 NB",  "45.263451,-93.822538",
      "MN25 MM 066 NB",  "45.270469,-93.817312",
      "MN25 MM 067 NB",  "45.283280,-93.807741",
      "MN25 MM 068 NB",  "45.297919,-93.799702",
      
      "MN25 MM 042 SB",  "44.977891,-93.887473",
      "MN25 MM 043 SB",  "44.989690,-93.899324",
      "MN25 MM 044 SB",  "45.005054,-93.900190",
      "MN25 MM 045 SB",  "45.016511,-93.908419",
      "MN25 MM 046 SB",  "45.030498,-93.910278",
      "MN25 MM 047 SB",  "45.044948,-93.910643",
      "MN25 MM 048 SB",  "45.059422,-93.910910",
      "MN25 MM 051 SB",  "45.072493,-93.868989",
      "MN25 MM 052 SB",  "45.086995,-93.868905",
      "MN25 MM 053 SB",  "45.101395,-93.868882",
      "MN25 MM 054 SB",  "45.115806,-93.868333",
      "MN25 MM 055 SB",  "45.130518,-93.868628",
      "MN25 MM 056 SB",  "45.144475,-93.868375",
      "MN25 MM 057 SB",  "45.158984,-93.868223",
      "MN25 MM 058 SB",  "45.171673,-93.876267",
      "MN25 MM 059 SB",  "45.186306,-93.876175",
      "MN25 MM 060 SB",  "45.199299,-93.869013",
      "MN25 MM 061 SB",  "45.209979,-93.856580",
      "MN25 MM 062 SB",  "45.222911,-93.847982",
      "MN25 MM 063 SB",  "45.237285,-93.847137",
      "MN25 MM 064 SB",  "45.251691,-93.834778",
      "MN25 MM 065 SB",  "45.263451,-93.822538",
      "MN25 MM 066 SB",  "45.270469,-93.817312",
      "MN25 MM 067 SB",  "45.283280,-93.807741",
      "MN25 MM 068 SB",  "45.297919,-93.799702",
      
      
      "MN55 MM 135 EB",  "45.296046,-94.247681",
      "MN55 MM 136 EB",  "45.293021,-94.227455",
      "MN55 MM 137 EB",  "45.290078,-94.208603",
      "MN55 MM 138 EB",  "45.281159,-94.192512",
      "MN55 MM 139 EB",  "45.273562,-94.175331",
      "MN55 MM 140 EB",  "45.269268,-94.155828",
      "MN55 MM 141 EB",  "45.265450,-94.136138",
      "MN55 MM 142 EB",  "45.258896,-94.117751",
      "MN55 MM 143 EB",  "45.252306,-94.099238",
      "MN55 MM 144 EB",  "45.245883,-94.081353",
      "MN55 MM 145 EB",  "45.242033,-94.061414",
      "MN55 MM 146 EB",  "45.237555,-94.042316",
      "MN55 MM 147 EB",  "45.232883,-94.022975",
      "MN55 MM 148 EB",  "45.232168,-94.002823",
      "MN55 MM 149 EB",  "45.227582,-93.984998",
      "MN55 MM 150 EB",  "45.222689,-93.967019",
      "MN55 MM 151 EB",  "45.216831,-93.945943",
      "MN55 MM 152 EB",  "45.210300,-93.927504",
      "MN55 MM 153 EB",  "45.201845,-93.910554",
      "MN55 MM 154 EB",  "45.193436,-93.894274",
      "MN55 MM 155 EB",  "45.184166,-93.879100",
      "MN55 MM 156 EB",  "45.174210,-93.864287",
      "MN55 MM 157 EB",  "45.160706,-93.855627",
      "MN55 MM 158 EB",  "45.149741,-93.842803",
      "MN55 MM 159 EB",  "45.138692,-93.829677",
      "MN55 MM 160 EB",  "45.126949,-93.817832",
      "MN55 MM 161 EB",  "45.115714,-93.806496",
      "MN55 MM 162 EB",  "45.113019,-93.787103",
      "MN55 MM 163 EB",  "45.101341,-93.775282",
      "MN55 MM 164 EB",  "45.093426,-93.757582",
      "MN55 MM 165 EB",  "45.089228,-93.740515",
      
      "MN55 MM 135 WB",  "45.296046,-94.247681",
      "MN55 MM 136 WB",  "45.293021,-94.227455",
      "MN55 MM 137 WB",  "45.290078,-94.208603",
      "MN55 MM 138 WB",  "45.281159,-94.192512",
      "MN55 MM 139 WB",  "45.273562,-94.175331",
      "MN55 MM 140 WB",  "45.269268,-94.155828",
      "MN55 MM 141 WB",  "45.265450,-94.136138",
      "MN55 MM 142 WB",  "45.258896,-94.117751",
      "MN55 MM 143 WB",  "45.252306,-94.099238",
      "MN55 MM 144 WB",  "45.245883,-94.081353",
      "MN55 MM 145 WB",  "45.242033,-94.061414",
      "MN55 MM 146 WB",  "45.237555,-94.042316",
      "MN55 MM 147 WB",  "45.232883,-94.022975",
      "MN55 MM 148 WB",  "45.232168,-94.002823",
      "MN55 MM 149 WB",  "45.227582,-93.984998",
      "MN55 MM 150 WB",  "45.222689,-93.967019",
      "MN55 MM 151 WB",  "45.216831,-93.945943",
      "MN55 MM 152 WB",  "45.210300,-93.927504",
      "MN55 MM 153 WB",  "45.201845,-93.910554",
      "MN55 MM 154 WB",  "45.193436,-93.894274",
      "MN55 MM 155 WB",  "45.184166,-93.879100",
      "MN55 MM 156 WB",  "45.174210,-93.864287",
      "MN55 MM 157 WB",  "45.160706,-93.855627",
      "MN55 MM 158 WB",  "45.149741,-93.842803",
      "MN55 MM 159 WB",  "45.138692,-93.829677",
      "MN55 MM 160 WB",  "45.126949,-93.817832",
      "MN55 MM 161 WB",  "45.115714,-93.806496",
      "MN55 MM 162 WB",  "45.113019,-93.787103",
      "MN55 MM 163 WB",  "45.101341,-93.775282",
      "MN55 MM 164 WB",  "45.093426,-93.757582",
      "MN55 MM 165 WB",  "45.089228,-93.740515",

      "MN101 MM 042 NB",  "45.227820,-93.552318",
      "MN101 MM 043 NB",  "45.242932,-93.555275",
      "MN101 MM 044 NB",  "45.257400,-93.555227",
      "MN101 MM 045 NB",  "45.272005,-93.556284",
      "MN101 MM 046 NB",  "45.285546,-93.561326",
      "MN241 MM 000 EB",  "45.210151,-93.664806",
      "MN241 MM 001 EB",  "45.210718,-93.644190",
      "MN241 MM 002 EB",  "45.212560,-93.623949",
      "MN241 MM 003 EB",  "45.214706,-93.603612",
      
      "MN101 MM 042 SB",  "45.227820,-93.552318",
      "MN101 MM 043 SB",  "45.242932,-93.555275",
      "MN101 MM 044 SB",  "45.257400,-93.555227",
      "MN101 MM 045 SB",  "45.272005,-93.556284",
      "MN101 MM 046 SB",  "45.285546,-93.561326",
      
      "MN241 MM 000 WB",  "45.210151,-93.664806",
      "MN241 MM 001 WB",  "45.210718,-93.644190",
      "MN241 MM 002 WB",  "45.212560,-93.623949",
      "MN241 MM 003 WB",  "45.214706,-93.603612"
  });
}
