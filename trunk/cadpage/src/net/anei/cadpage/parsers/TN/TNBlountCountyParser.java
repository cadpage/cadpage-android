package net.anei.cadpage.parsers.TN;

import net.anei.cadpage.parsers.FieldProgramParser;
import net.anei.cadpage.parsers.MsgInfo.Data;

/* 
Blount County, TN
Contact: Andrew Puckett <APuckett@maryville-tn.gov>
Sender: @c-msg.net
CodeMessage Account 627

FIRE ALARM | 304, PARTNERSHIP PKWY;MARYVILLE (DEAD END OF ROAD / WEST LAMAR ALEXANDER PKWY) | ADVANCED CATALYST | 2012-06-25 09:27:44 |
SICK PERSON | 223, ROYAL OAKS DR;MARYVILLE (MEDINAH CIR / MEDINAH CIR) | 73 YR FEMALE | 2012-06-25 06:59:15 |
MEDICAL ALARM | 247, ROYAL OAKS DR;MARYVILLE (MEDINAH CIR / WINGED FOOT DR) | MURRAY RES | 2012-06-25 06:40:47 |
SICK PERSON | 2648, SEVIERVILLE RD;MARYVILLE (CANDORA RD / BONNIE VISTA DR) | ROOM B25 ELDERLY SUBJ DIFF BREATHING | 2012-06-25 06:34:11 |
LIFT ASSIST | 223, ROYAL OAKS DR;MARYVILLE (MEDINAH CIR / MEDINAH CIR) | 75 YR FEMALE FELL OUT OF BED | 2012-06-25 06:22:14 |
SICK PERSON | 404, MCGHEE ST;MARYVILLE (MCMASTER PL / WINTER ST) | 54 YEAR OLD FEMALE DIFF BREATHING...ALOT OF PAIN ON HER RIGHT SIDE | 2012-06-24 22:35:00 |
FIRE INVESTIGATION OUTSIDE | 1207, LENORE LN;MARYVILLE (ECKLES DR / WESTFIELD DR) | | 2012-06-24 22:25:46 |
ATT SUICIDE | 208, BARNES AVE;MARYVILLE (BRANNON DR / MONTVALE RD) | 29 YR OLD MALE, TOOK UNKNOWN PILL, UNLKNOW HOW LONG AGO. | 2012-06-24 21:59:58 |
SICK PERSON | 836, HOLLY ST;MARYVILLE (ASH AVE / DEAD END OF ROAD) | 58YOF SICK | 2012-06-24 21:55:56 |
INJURED PERSON | 1615, NORTHFIELD DR;MARYVILLE (DEAD END OF ROAD / WOODGATE DR) | 68 MALE FELL, RIB PAIN | 2012-06-24 17:13:45 |
LIFT ASSIST | 205, BROADWAY TOWERS ;MARYVILLE (NORTH CUSICK ST / CATES ST) | 350 LB MALE IN FLOOR, UNHURT BUT NEEDS HELP UP | 2012-06-24 11:25:16 |
SICK PERSON | 2320, EAST LAMAR ALEXANDER PKWY;MARYVILLE (MERRITT RD / GRANDVIEW DR) | TCC ROOM 206...ELDERLY FEMALE DIFF BREATHING | 2012-06-24 08:24:11 |
SICK PERSON | 524, NORTH HOUSTON ST;MARYVILLE (LANDAU DR / LANDAU DR) | 66 YR OLD FEM , | 2012-06-24 04:34:05 |
SICK PERSON | 1202, JEFFERSON AVE;MARYVILLE (WRIGHT RD / RULE ST) | 9YR OLD FEMALE WOKE UP SCREAMING, RUNNING AROUND THE HOUSE. | 2012-06-24 02:03:06 |
FIRE BRUSH | 505, NORTH FOOTHILLS PLAZA DR;MARYVILLE (MALL RD / SOUTH FOOTHILLS PLAZA) | ABOUT 4 FOOT. | 2012-06-23 21:25:43 |
MVA PERSONAL INJURY | 2715, U S HIGHWAY 411 S ;MARYVILLE (PLYMOUTH DR / NICOLE CRT) | ONE PARTY INJURIED. | 2012-06-23 20:33:16 |
SICK PERSON | 109, NORTH EVERETT HIGH RD;MARYVILLE (EAST HARPER AVE / JEFFERSON AVE) | APT 3 | 2012-06-23 19:54:47 |
MVA PROPERTY DAMAGE | 721, SOUTH EVERETT HIGH RD;MARYVILLE (MORNINGSIDE AVE / KITTRELL AVE) | BLK SUV RAN THRU A YARD, HIT A HOUSE AND THEN A TREE 635NTB | 2012-06-23 18:54:09 |
FIRE STRUCTURE | 362, POINT CIR;MARYVILLE (PACIFIC AVE / DEAD END OF ROAD) | FEMALE BLIND. | 2012-06-23 15:58:30 |
SICK PERSON | 401, MONTVALE STATION RD;MARYVILLE (MONTVALE RD / SOUTH CEDAR ST) | FEMALE. 36 AGE. | 2012-06-23 15:37:59 |
SICK PERSON | 1035, YOUNG AVE;MARYVILLE (NORTH RUTH ST / BURWOOD ST) | DOG IN HOUSE. FEMALE. AGE 39. | 2012-06-23 14:10:50 |
INJURED PERSON | 807, FOOTHILLS MALL DR;MARYVILLE (WEST LAMAR ALEXANDER PKWY / TURNER ST) | FEMALE FELL NEEDS AMBULANCE | 2012-06-23 12:54:13 |
FIRE ALARM | 132, WEST BROADWAY AVE;MARYVILLE (NORTH CUSICK ST / CATES ST) | broadway towers | 2012-06-23 10:32:23 |
SICK PERSON | 511, PEARSON SPRINGS RD;MARYVILLE (SANDY SPRINGS RD / EAST WESTWOOD DR) | EDERLY FEMALE SUBJ TACHACADIAC SHAKING | 2012-06-23 08:57:43 |
SICK PERSON | 179, SUNSET VIEW LOOP;MARYVILLE (WATKINS RD / DEAD END OF ROAD) | 82 yof | 2012-06-23 07:08:31 |
SICK PERSON | 2320, EAST LAMAR ALEXANDER PKWY;MARYVILLE (MERRITT RD / GRANDVIEW DR) | TCC 88 YR OLD DIFF BREATHING, FULL CODE | 2012-06-23 02:12:27 |
SICK PERSON | 804, SHANNONDALE WAY;MARYVILLE (MONTCLAIR CIR / OVA BROADY LN) | ROOM 107 88YOM SHAKING, ABDOMINAL PAIN | 2012-06-22 21:27:04 |
FIRE ALARM | 1221, BASTOGNE DR;MARYVILLE (WORTHINGTON BLVD / ELSBORN RIDGE RD) | CHRIS WITH LIFELINE / HE SPOKE TO HOMEOWNER AND SHE HAS SOME TYPE OF ALARM GOING OFF AND NOT SURE WHAT IT IS | 2012-06-22 16:39:50 |
SICK PERSON | 1742, OLD NILES FERRY RD;MARYVILLE (MONTGOMERY LN / SANDY SPRINGS RD) | 91 YOM HEART OUT OF RHYTHM AGAIN, DIFF BREATHING A BIT | 2012-06-22 16:17:40 |
FIRE BRUSH | 600, WEST BROADWAY AVE;MARYVILLE (CUNNINGHAM ST / CURTIS ST) | ACROSS FROM DOWNTOWN AUTOBODY IN THE CHURCH PARKING LOT | 2012-06-22 14:04:05 |

 */

public class TNBlountCountyParser extends FieldProgramParser {
  
  public TNBlountCountyParser() {
    super("BLOUNT COUNTY", "TN",
           "CALL ADDR INFO DATETIME!");
  }
  
  @Override
  public String getFilter() {
    return "page@tnacso.net";
  }

  @Override
  protected boolean parseMsg(String subject, String body, Data data) {
    return parseFields(body.split("\\|"), 4, data);
  }

  private class MyAddressField extends AddressField {
    @Override
    public void parse(String field, Data data) {
      field = field.replace(",", "");
      Parser p = new Parser(field);
      parseAddress(p.get(';'), data);
      data.strCity = p.get('(');
      data.strCross = p.get(')');
      data.strSupp = p.get();
    }
    
    @Override
    public String getFieldNames() {
      return "ADDR APT CITY X";
    }
  }
  
  private class MyDateTimeField extends DateTimeField {
    public MyDateTimeField() {
      super("\\d{4}-\\d\\d-\\d\\d \\d\\d:\\d\\d:\\d\\d", true);
    }
    
    @Override
    public void parse(String field, Data data) {
      data.strDate = field.substring(5,7) + '/' + field.substring(8,10) + '/' + field.substring(0,4);
      data.strTime = field.substring(11);
    }
  }
  
  @Override
  public Field getField(String name) {
    if (name.equals("ADDR")) return new MyAddressField();
    if (name.equals("DATETIME")) return new MyDateTimeField();
    return super.getField(name);
  }
}
